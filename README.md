# Customer Insights & Revenue Optimization Analytics

This project focuses on analyzing various aspects of a DVD rental business through SQL queries. The analysis is split into multiple parts:

1. **Part 1: Movie & Category Performance**  
   Analyzes the performance of movies and categories based on rental data.

2. **Part 2: Customer Insights**  
   Focuses on customer behavior and segmentation, including RFM analysis.

3. **Part 3: Revenue & Payments**  
   Explores revenue generation across different categories, films, and payment methods.

4. **Part 4: Store Performance**  
   Compares store performance, staff efficiency, and rental trends.

---

## How to Use This Repository

1. Navigate to the relevant part folder (e.g., `part-1-movie-category-performance/`) for SQL queries and analysis.
2. Check the `README.md` in each part for more specific details on the analysis and insights.

---

## Part 1: Movie & Category Performance

This part analyzes movie and category performance based on rental data. It includes queries for the top 10 most-rented movies, most popular film categories, and revenue generation by category.

### 1. Top 10 Most-Rented Movies

```sql
SELECT 
    f.title,
    c.name AS category,
    COUNT(r.rental_id) AS movie_rental_count
FROM 
    film f
INNER JOIN 
    inventory i ON f.film_id = i.film_id
INNER JOIN 
    rental r ON i.inventory_id = r.inventory_id
INNER JOIN 
    film_category fc ON f.film_id = fc.film_id
INNER JOIN 
    category c ON fc.category_id = c.category_id  
GROUP BY 
    f.film_id, f.title, c.name
ORDER BY 
    movie_rental_count DESC
LIMIT 10;
```
Insight: The most-rented movies are predominantly Travel and Foreign titles, indicating a customer preference for culturally rich or globally themed content.


### 2. Top 5 Most Popular Film Categories

```sql
SELECT * FROM 
(
    SELECT 
        c.name, 
        COUNT(fc.film_id) AS count_of_film_categories,
        DENSE_RANK() OVER (ORDER BY COUNT(fc.film_id) DESC) AS category_rank
    FROM 
        film f
    INNER JOIN 
        film_category fc ON f.film_id = fc.film_id
    INNER JOIN 
        category c ON fc.category_id = c.category_id
    GROUP BY 
        c.name
    ORDER BY 
        category_rank
) AS ranked_categories
WHERE category_rank BETWEEN 1 AND 5;
```
Insight: Sports remains the most popular film category, followed closely by Foreign and Family, suggesting a demand for fast-paced and thrilling genres.

### 3. Revenue Generated by Each Film Category

```sql
SELECT 
    c.name AS category,
    SUM(p.amount) AS total_revenue
FROM 
    payment p
JOIN 
    rental r ON p.rental_id = r.rental_id
JOIN 
    inventory i ON r.inventory_id = i.inventory_id
JOIN 
    film f ON i.film_id = f.film_id
JOIN 
    film_category fc ON f.film_id = fc.film_id
JOIN 
    category c ON fc.category_id = c.category_id
GROUP BY 
    c.name
ORDER BY 
    total_revenue DESC;
```
Insight: Sports, Sci-Fi, Animation, and Drama are the top revenue-generating categories, reflecting a strong customer appetite for both high-adrenaline and emotionally engaging storytelling.

## Part 2: Customer Insights

This part focuses on customer behavior and engagement. It includes queries for top spenders, customer distribution by country, RFM analysis and rental day preferences.

### 1. Top 10 Customers by Total Spending

```sql
SELECT 
    c.customer_id,
    c.first_name,
    c.last_name,
    SUM(p.amount) AS total_spent
FROM 
    customer c
INNER JOIN 
    payment p ON c.customer_id = p.customer_id
GROUP BY 
    c.customer_id, c.first_name, c.last_name
ORDER BY 
    total_spent DESC
LIMIT 10;
```
Insight: These top spenders are key revenue contributors, highlighting high-value customers worth targeting for loyalty rewards.


### 2. Top 10 Countries by Number of Customers

```sql
SELECT 
    country,
    COUNT(*) AS total_customers
FROM 
    customer c 
JOIN 
    address a ON c.address_id = a.address_id  
JOIN 
    city ci ON a.city_id = ci.city_id 
JOIN 
    country co ON ci.country_id = co.country_id
GROUP BY 
    country
ORDER BY 
    total_customers DESC
LIMIT 10;
```
Insight: India, China, and the United States account for the largest customer bases, indicating strong market potential in Asia and North America for targeted campaigns or business growth.

### 3. RFM Analysis: Recency, Frequency, and Monetary Value per Customer

```sql
SELECT 
    r.customer_id,
    CURRENT_DATE - MAX(r.rental_date) AS recency,   -- Recency: Date difference between today and most recent rental date
    COUNT(r.rental_id) AS frequency,                 -- Frequency: Count of rentals per customer
    SUM(p.amount) AS monetary                        -- Monetary: Total amount spent by the customer
FROM 
    rental r
JOIN 
    payment p ON r.rental_id = p.rental_id
GROUP BY 
    r.customer_id
ORDER BY 
    recency, frequency DESC, monetary DESC;
```
Insight: RFM scores identify your most valuable and loyal customers, enabling strategic segmentation for marketing efforts.

### 4. RFM Analysis: Recency, Frequency, and Monetary Value per Customer

```sql
SELECT 
    TO_CHAR(rental_date, 'Day') AS rental_day,
    COUNT(*) AS rental_count
FROM 
    rental
GROUP BY 
    rental_day
ORDER BY 
    rental_count DESC;
```
Insight: Rental activity peaks on weekends, with Friday, Saturday, and Sunday being the busiest days—suggesting strong demand for leisure-time entertainment and ideal timing for promotional campaigns.

## Part 3: Revenue & Payments

### 1. How does revenue vary on a monthly basis?

```sql
SELECT 
    TO_CHAR(payment_date, 'Month') AS month,
    EXTRACT(MONTH FROM payment_date) AS month_number,
    SUM(amount) AS total_amount
FROM 
    payment
GROUP BY 
    TO_CHAR(payment_date, 'Month'),
    EXTRACT(MONTH FROM payment_date)
ORDER BY 
    total_amount DESC;
```
Insight: Revenue peaks in the spring months — especially April and March — indicating strong seasonal demand during the first half of the year. This pattern can help guide marketing and inventory strategies for early-year engagement.

### 2. How are movies distributed across different length categories?

```sql
SELECT 
    CASE
        WHEN length <= 60 THEN 'Short Movie'        -- Documentaries, kids' specials
        WHEN length < 90 THEN 'Medium'              -- Shorter feature films or indie titles
        WHEN length < 120 THEN 'Feature'            -- Standard-length movies
        ELSE 'Extended'                             -- Long features or epic films
    END AS length_category,
    COUNT(*) AS movie_count
FROM 
    film
GROUP BY 
    length_category
ORDER BY 
    movie_count DESC;
```
Insight: The majority of movies fall into the Extended and Feature categories, with extended films leading the count. This suggests a preference for longer, more immersive viewing experiences, with shorter films (Medium and Short) playing a more niche role in the rental market.

### 3. What time of day generates the most revenue?

```sql
SELECT 
    EXTRACT(HOUR FROM payment_date) AS hour_of_day,
    SUM(amount) AS total_revenue
FROM 
    payment
GROUP BY 
    hour_of_day
ORDER BY 
    total_revenue DESC;
```
Insight: The peak revenue hours are 18:00 (6 PM), 08:00 (8 AM), 14:00 (2 PM), and 00:00 (midnight), This pattern reflects both early risers and night-time users, indicating consistent demand throughout the day with surges around commuting and leisure hours.











