# DVD Rental Analytics

This project focuses on analyzing various aspects of a DVD rental business through SQL queries. The analysis is split into multiple parts:

1. **Part 1: Movie & Category Performance**  
   Analyzes the performance of movies and categories based on rental data.

2. **Part 2: Customer Insights**  
   Focuses on customer behavior and segmentation, including RFM analysis.

3. **Part 3: Revenue & Payments**  
   Explores revenue generation across different categories, films, and payment methods.

4. **Part 4: Store Performance**  
   Compares store performance, staff efficiency, and rental trends.

---

## How to Use This Repository

1. Navigate to the relevant part folder (e.g., `part-1-movie-category-performance/`) for SQL queries and analysis.
2. Check the `README.md` in each part for more specific details on the analysis and insights.

---

## Part 1: Movie & Category Performance

This part analyzes movie and category performance based on rental data. It includes queries for the top 10 most-rented movies, most popular film categories, and revenue generation by category.

### 1. Top 10 Most-Rented Movies

```sql
SELECT 
    f.title,
    c.name AS category,
    COUNT(r.rental_id) AS movie_rental_count
FROM 
    film f
INNER JOIN 
    inventory i ON f.film_id = i.film_id
INNER JOIN 
    rental r ON i.inventory_id = r.inventory_id
INNER JOIN 
    film_category fc ON f.film_id = fc.film_id
INNER JOIN 
    category c ON fc.category_id = c.category_id  
GROUP BY 
    f.film_id, f.title, c.name
ORDER BY 
    movie_rental_count DESC
LIMIT 10;
```
Insight: The most-rented movies are predominantly Travel and Foreign titles, indicating a customer preference for culturally rich or globally themed content.


### 2. Top 5 Most Popular Film Categories

```sql
SELECT * FROM 
(
    SELECT 
        c.name, 
        COUNT(fc.film_id) AS count_of_film_categories,
        DENSE_RANK() OVER (ORDER BY COUNT(fc.film_id) DESC) AS category_rank
    FROM 
        film f
    INNER JOIN 
        film_category fc ON f.film_id = fc.film_id
    INNER JOIN 
        category c ON fc.category_id = c.category_id
    GROUP BY 
        c.name
    ORDER BY 
        category_rank
) AS ranked_categories
WHERE category_rank BETWEEN 1 AND 5
```
Insight: Sports remains the most popular film category, followed closely by Foreign and Family, suggesting a demand for fast-paced and thrilling genres.

### 3. Revenue Generated by Each Film Category

```sql
SELECT 
    c.name AS category,
    SUM(p.amount) AS total_revenue
FROM 
    payment p
JOIN 
    rental r ON p.rental_id = r.rental_id
JOIN 
    inventory i ON r.inventory_id = i.inventory_id
JOIN 
    film f ON i.film_id = f.film_id
JOIN 
    film_category fc ON f.film_id = fc.film_id
JOIN 
    category c ON fc.category_id = c.category_id
GROUP BY 
    c.name
ORDER BY 
    total_revenue DESC
```
Sports, Sci-Fi, Animation, and Drama are the top revenue-generating categories, reflecting a strong customer appetite for both high-adrenaline and emotionally engaging storytelling.



